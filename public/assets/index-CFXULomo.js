import{_ as j}from"./AppTextField-C9i3rMo7.js";import{r as n,ad as E,D as F,f as I,e as t,o as M,b as e,a3 as c,s as u,t as f,$ as y,a2 as N}from"./main-Dc8fLLio.js";import{a as d}from"./axios-DGDcxXwr.js";import{V as k,a as V}from"./VRow-TywjCKkg.js";import{V as C,b as S}from"./VCard-CkB6CIXi.js";import{V as A}from"./VCardText-DxD8k5-8.js";import{V as P}from"./VDataTable-CnUCRCFb.js";import{V as O}from"./VChip-DXfzaw2X.js";import{V as R}from"./VForm-BF-thogD.js";import{V as h}from"./VSelect-CFNDzyn7.js";import{V as Z}from"./VDialog-B0k7aTaW.js";import"./VTextField-BtIlFlGn.js";import"./VImg-BDT53czw.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VAvatar-CuFlpItv.js";import"./VPagination-tEoifavA.js";import"./VCheckboxBtn-DoNR63xf.js";import"./VSelectionControl-B1Qq_A9U.js";import"./VDivider-D6pnG8a5.js";import"./VList-DJa-ehqo.js";import"./VOverlay-C_apeV14.js";import"./scopeId-CyTsLL5x.js";import"./VMenu-Bs42EHWd.js";const fe={__name:"index",setup(q){const _=n([]),b=n([]),p=n(!1),i=n(!1),l=n({centre_id:null,status:"active",start_date:null,end_date:null,price:0}),s=E("accessToken").value,D=[{title:"Active",value:"active"},{title:"Suspended",value:"suspended"},{title:"Cancelled",value:"cancelled"}],g=[{title:"ID",key:"id"},{title:"Centre",key:"centre.name"},{title:"Status",key:"status"},{title:"Start Date",key:"start_date"},{title:"End Date",key:"end_date"},{title:"Price",key:"price"},{title:"Actions",key:"actions"}],m=async()=>{p.value=!0;try{const{data:o}=await d.get("/api/admin/subscriptions",{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}});_.value=o}catch(o){console.error(o)}finally{p.value=!1}},w=async()=>{try{const{data:o}=await d.get("/api/admin/centres",{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}});b.value=o}catch(o){console.error(o)}},x=()=>{l.value={centre_id:null,status:"active",start_date:null,end_date:null,price:0},i.value=!0},$=o=>{l.value={...o},i.value=!0},B=async()=>{try{l.value.id?await d.put(`/api/admin/subscriptions/${l.value.id}`,{...l.value,headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}}):await d.post("/api/admin/subscriptions",l.value,{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}}),i.value=!1,m()}catch(o){console.error(o)}},z=async o=>{try{await d.delete(`/api/admin/subscriptions/${o}`,{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}}),m()}catch(r){console.error(r)}},T=o=>{switch(o){case"active":return"success";case"suspended":return"warning";case"cancelled":return"error";default:return"secondary"}};return F(()=>{m(),w()}),(o,r)=>{const v=j;return M(),I(k,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(C,null,{default:t(()=>[e(S,null,{default:t(()=>[e(c,{color:"primary",onClick:x},{default:t(()=>[u(" Add Subscription ")]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(P,{headers:g,items:_.value,loading:p.value},{"item.status":t(({item:a})=>[e(O,{color:T(a.status)},{default:t(()=>[u(f(a.status),1)]),_:2},1032,["color"])]),"item.price":t(({item:a})=>[u(f(a.price)+" DZD ",1)]),"item.actions":t(({item:a})=>[e(c,{icon:"",size:"small",color:"primary",variant:"text",onClick:U=>$(a)},{default:t(()=>[e(y,{icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(c,{icon:"",size:"small",color:"error",variant:"text",onClick:U=>z(a.id)},{default:t(()=>[e(y,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),_:2},1032,["items","loading"])]),_:1})]),_:1})]),_:1}),e(Z,{modelValue:i.value,"onUpdate:modelValue":r[5]||(r[5]=a=>i.value=a),"max-width":"800"},{default:t(()=>[e(C,null,{default:t(()=>[e(S,null,{default:t(()=>[u(f(l.value.id?"Edit":"Add")+" Subscription",1)]),_:1}),e(A,null,{default:t(()=>[e(R,{onSubmit:N(B,["prevent"])},{default:t(()=>[e(h,{modelValue:l.value.centre_id,"onUpdate:modelValue":r[0]||(r[0]=a=>l.value.centre_id=a),items:b.value,"item-title":"name","item-value":"id",label:"Centre",class:"mb-4"},null,8,["modelValue","items"]),e(h,{modelValue:l.value.status,"onUpdate:modelValue":r[1]||(r[1]=a=>l.value.status=a),items:D,label:"Status",class:"mb-4"},null,8,["modelValue"]),e(k,{class:"mb-4"},{default:t(()=>[e(V,{cols:"12",md:"6"},{default:t(()=>[e(v,{modelValue:l.value.start_date,"onUpdate:modelValue":r[2]||(r[2]=a=>l.value.start_date=a),label:"Start Date",type:"date"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:t(()=>[e(v,{modelValue:l.value.end_date,"onUpdate:modelValue":r[3]||(r[3]=a=>l.value.end_date=a),label:"End Date",type:"date"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{modelValue:l.value.price,"onUpdate:modelValue":r[4]||(r[4]=a=>l.value.price=a),label:"Price",type:"number",min:"0",step:"0.01",class:"mb-4"},null,8,["modelValue"]),e(c,{type:"submit",color:"primary"},{default:t(()=>[u(" Save ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{fe as default};
