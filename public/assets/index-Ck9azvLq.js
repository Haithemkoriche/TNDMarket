import{_ as N}from"./AppTextarea-B2vjwZ3z.js";import{_ as j}from"./AppTextField-C9i3rMo7.js";import{r as u,ad as z,D as L,f as p,e as a,o as s,b as e,a3 as k,s as f,$ as P,a2 as R,c as S,h as E,F as M,x as A}from"./main-Dc8fLLio.js";import{a as _}from"./axios-DGDcxXwr.js";import{V as w,a as y}from"./VRow-TywjCKkg.js";import{V as h,b as x}from"./VCard-CkB6CIXi.js";import{V as F}from"./VCardText-DxD8k5-8.js";import{V as O}from"./VDataTable-CnUCRCFb.js";import{V as I}from"./VForm-BF-thogD.js";import{V as q}from"./VSelect-CFNDzyn7.js";import{V as G}from"./VDialog-B0k7aTaW.js";import"./VTextField-BtIlFlGn.js";import"./VImg-BDT53czw.js";import"./forwardRefs-DWGaNmQL.js";import"./VTextarea-CYzPfUum.js";/* empty css              */import"./VAvatar-CuFlpItv.js";import"./VPagination-tEoifavA.js";import"./VCheckboxBtn-DoNR63xf.js";import"./VSelectionControl-B1Qq_A9U.js";import"./VChip-DXfzaw2X.js";import"./VDivider-D6pnG8a5.js";import"./VList-DJa-ehqo.js";import"./VOverlay-C_apeV14.js";import"./scopeId-CyTsLL5x.js";import"./VMenu-Bs42EHWd.js";const be={__name:"index",setup(H){const g=u([]),V=u([]),v=u(!1),d=u(!1),t=u({form_type_id:null,patient_name:"",patient_surname:"",form_data:{}}),C=[{title:"ID",key:"id"},{title:"Patient",key:"patient_name"},{title:"Type",key:"form_type.name"},{title:"Date",key:"created_at"},{title:"Actions",key:"actions"}],c=z("accessToken").value,T=async()=>{v.value=!0;try{const{data:r}=await _.get("/api/forms",{headers:{Authorization:`Bearer ${c}`,Accept:"application/json"}});g.value=r}catch(r){console.error(r)}finally{v.value=!1}},U=async()=>{try{const{data:r}=await _.get("/api/form-types",{headers:{Authorization:`Bearer ${c}`,Accept:"application/json"}});V.value=r}catch(r){console.error(r)}},$=()=>{t.value={form_type_id:null,patient_name:"",patient_surname:"",form_data:{}},d.value=!0},B=async()=>{try{await _.post("/api/forms",t.value,{headers:{Authorization:`Bearer ${c}`,Accept:"application/json"}}),d.value=!1,T()}catch(r){console.error(r)}},D=async r=>{try{const o=await _.get(`/api/forms/${r}/pdf`,{responseType:"blob",headers:{Authorization:`Bearer ${c}`,Accept:"application/pdf"}}),m=window.URL.createObjectURL(new Blob([o.data],{type:"application/pdf"})),i=document.createElement("a");i.href=m,i.setAttribute("download",`form_${r}.pdf`),document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(m),window.open(m)}catch(o){console.error("PDF generation error:",o.response||o.message||o)}};return L(()=>{T(),U()}),(r,o)=>{const m=j,i=N;return s(),p(w,null,{default:a(()=>[e(y,{cols:"12"},{default:a(()=>[e(h,null,{default:a(()=>[e(x,null,{default:a(()=>[e(k,{color:"primary",onClick:$},{default:a(()=>[f(" New Form ")]),_:1})]),_:1}),e(F,null,{default:a(()=>[e(O,{headers:C,items:g.value,loading:v.value},{"item.actions":a(({item:n})=>[e(k,{icon:"",size:"small",color:"primary",variant:"text",onClick:l=>D(n.id)},{default:a(()=>[e(P,{icon:"tabler-file-download"})]),_:2},1032,["onClick"])]),_:2},1032,["items","loading"])]),_:1})]),_:1})]),_:1}),e(G,{modelValue:d.value,"onUpdate:modelValue":o[3]||(o[3]=n=>d.value=n),"max-width":"800"},{default:a(()=>[e(h,null,{default:a(()=>[e(x,null,{default:a(()=>[f("Create New Form")]),_:1}),e(F,null,{default:a(()=>[e(I,{onSubmit:R(B,["prevent"])},{default:a(()=>[e(q,{modelValue:t.value.form_type_id,"onUpdate:modelValue":o[0]||(o[0]=n=>t.value.form_type_id=n),items:V.value,"item-title":"name","item-value":"id",label:"Form Type",class:"mb-4"},null,8,["modelValue","items"]),e(w,null,{default:a(()=>[e(y,{cols:"12",md:"6"},{default:a(()=>[e(m,{modelValue:t.value.patient_name,"onUpdate:modelValue":o[1]||(o[1]=n=>t.value.patient_name=n),label:"Patient Name"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:a(()=>[e(m,{modelValue:t.value.patient_surname,"onUpdate:modelValue":o[2]||(o[2]=n=>t.value.patient_surname=n),label:"Patient Surname"},null,8,["modelValue"])]),_:1})]),_:1}),t.value.form_type_id?(s(),p(h,{key:0,class:"mb-4"},{default:a(()=>[e(x,null,{default:a(()=>[f("Form Fields")]),_:1}),e(F,null,{default:a(()=>[e(w,null,{default:a(()=>{var n;return[(s(!0),S(M,null,E(((n=V.value.find(l=>l.id===t.value.form_type_id))==null?void 0:n.fields)||[],l=>(s(),p(y,{key:l.name,cols:"12"},{default:a(()=>[l.type==="text"||l.type==="number"?(s(),p(m,{key:0,modelValue:t.value.form_data[l.name],"onUpdate:modelValue":b=>t.value.form_data[l.name]=b,label:l.label,type:l.type==="number"?"number":"text"},null,8,["modelValue","onUpdate:modelValue","label","type"])):l.type==="textarea"?(s(),p(i,{key:1,modelValue:t.value.form_data[l.name],"onUpdate:modelValue":b=>t.value.form_data[l.name]=b,label:l.label},null,8,["modelValue","onUpdate:modelValue","label"])):A("",!0)]),_:2},1024))),128))]}),_:1})]),_:1})]),_:1})):A("",!0),e(k,{type:"submit",color:"primary"},{default:a(()=>[f(" Submit ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{be as default};
