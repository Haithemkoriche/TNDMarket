import{_ as de}from"./AppTextarea-B2vjwZ3z.js";import{_ as pe}from"./AppTextField-C9i3rMo7.js";import{a6 as me,bb as X,a8 as fe,ap as ve,a9 as Ve,L as y,bc as L,r as f,w as ye,ab as ke,ax as he,b as t,p as D,F as R,aE as be,bd as ge,ad as U,D as Ce,f as O,e as u,o as Z,a3 as z,s as x,t as q,x as Pe,$ as G,a2 as _e}from"./main-Dc8fLLio.js";import{a as B}from"./axios-DGDcxXwr.js";import{V as H,a as M}from"./VRow-TywjCKkg.js";import{V as J,b as K}from"./VCard-CkB6CIXi.js";import{V as Q}from"./VCardText-DxD8k5-8.js";import{V as Ie}from"./VDataTable-CnUCRCFb.js";import{V as Ae}from"./VImg-BDT53czw.js";import{V as we}from"./VForm-BF-thogD.js";import{m as Se,d as Fe,u as ze,V as W,f as xe,e as Be,g as $e}from"./VTextField-BtIlFlGn.js";import{f as Te}from"./forwardRefs-DWGaNmQL.js";import{V as De}from"./VChip-DXfzaw2X.js";import{V as Re}from"./VDialog-B0k7aTaW.js";import"./VTextarea-CYzPfUum.js";/* empty css              */import"./VAvatar-CuFlpItv.js";import"./VPagination-tEoifavA.js";import"./VSelect-CFNDzyn7.js";import"./VList-DJa-ehqo.js";import"./VDivider-D6pnG8a5.js";import"./VOverlay-C_apeV14.js";import"./scopeId-CyTsLL5x.js";import"./VMenu-Bs42EHWd.js";import"./VCheckboxBtn-DoNR63xf.js";import"./VSelectionControl-B1Qq_A9U.js";const Ue=me({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},...Se({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>X(e).every(v=>v!=null&&typeof v=="object")},...Fe({clearable:!0})},"VFileInput"),Me=fe()({name:"VFileInput",inheritAttrs:!1,props:Ue(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,v){let{attrs:h,emit:d,slots:l}=v;const{t:p}=ve(),s=Ve(e,"modelValue",e.modelValue,a=>X(a),a=>e.multiple||Array.isArray(e.modelValue)?a:a[0]??null),{isFocused:V,focus:$,blur:b}=ze(e),I=y(()=>typeof e.showSize!="boolean"?e.showSize:void 0),A=y(()=>(s.value??[]).reduce((a,r)=>{let{size:C=0}=r;return a+C},0)),w=y(()=>L(A.value,I.value)),g=y(()=>(s.value??[]).map(a=>{const{name:r="",size:C=0}=a;return e.showSize?`${r} (${L(C,I.value)})`:r})),o=y(()=>{var r;const a=((r=s.value)==null?void 0:r.length)??0;return e.showSize?p(e.counterSizeString,a,w.value):p(e.counterString,a)}),n=f(),k=f(),c=f(),i=y(()=>V.value||e.active),S=y(()=>["plain","underlined"].includes(e.variant));function T(){var a;c.value!==document.activeElement&&((a=c.value)==null||a.focus()),V.value||$()}function Y(a){var r;(r=c.value)==null||r.click()}function ee(a){d("mousedown:control",a)}function te(a){var r;(r=c.value)==null||r.click(),d("click:control",a)}function le(a){a.stopPropagation(),T(),be(()=>{s.value=[],ge(e["onClick:clear"],a)})}return ye(s,a=>{(!Array.isArray(a)||!a.length)&&c.value&&(c.value.value="")}),ke(()=>{const a=!!(l.counter||e.counter),r=!!(a||l.details),[C,ae]=he(h),{modelValue:Ne,...oe}=W.filterProps(e),ne=xe(e);return t(W,D({ref:n,modelValue:s.value,"onUpdate:modelValue":P=>s.value=P,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":S.value},e.class],style:e.style,"onClick:prepend":Y},C,oe,{centerAffix:!S.value,focused:V.value}),{...l,default:P=>{let{id:F,isDisabled:_,isDirty:N,isReadonly:j,isValid:ie}=P;return t(Be,D({ref:k,"prepend-icon":e.prependIcon,onMousedown:ee,onClick:te,"onClick:clear":le,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},ne,{id:F.value,active:i.value||N.value,dirty:N.value||e.dirty,disabled:_.value,focused:V.value,error:ie.value===!1}),{...l,default:ue=>{var E;let{props:{class:re,...se}}=ue;return t(R,null,[t("input",D({ref:c,type:"file",readonly:j.value,disabled:_.value,multiple:e.multiple,name:e.name,onClick:m=>{m.stopPropagation(),j.value&&m.preventDefault(),T()},onChange:m=>{if(!m.target)return;const ce=m.target;s.value=[...ce.files??[]]},onFocus:T,onBlur:b},se,ae),null),t("div",{class:re},[!!((E=s.value)!=null&&E.length)&&!e.hideInput&&(l.selection?l.selection({fileNames:g.value,totalBytes:A.value,totalBytesReadable:w.value}):e.chips?g.value.map(m=>t(De,{key:m,size:"small",text:m},null)):g.value.join(", "))])])}})},details:r?P=>{var F,_;return t(R,null,[(F=l.details)==null?void 0:F.call(l,P),a&&t(R,null,[t("span",null,null),t($e,{active:!!((_=s.value)!=null&&_.length),value:o.value,disabled:e.disabled},l.counter)])])}:void 0})}),Te({},n,k,c)}}),pt={__name:"index",setup(e){const v=f([]),h=f(!1),d=f(!1),l=f({title:"",description:"",price:0,stock:0,photo:null}),p=f(null),s=[{title:"ID",key:"id"},{title:"Title",key:"title"},{title:"Price",key:"price"},{title:"Stock",key:"stock"},{title:"Photo",key:"photo"},{title:"Actions",key:"actions"}],V=U("accessToken").value,$=U("userRoles").value;console.log($);const b=async()=>{h.value=!0;try{const{data:o}=await B.get("/api/products",{headers:{Authorization:`Bearer ${V}`,Accept:"application/json"}});v.value=o}catch(o){console.error(o)}finally{h.value=!1}},I=()=>{l.value={title:"",description:"",price:0,stock:0,photo:null},p.value=null,d.value=!0},A=o=>{l.value={...o},d.value=!0},w=async()=>{try{const o=new FormData;o.append("title",l.value.title),o.append("description",l.value.description),o.append("price",l.value.price),o.append("stock",l.value.stock),p.value&&o.append("photo",p.value);const n=U("accessToken").value;console.log(n),l.value.id?(o.append("_method","PUT"),await B.post(`/api/products/${l.value.id}`,o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${n}`}})):await B.post("/api/products",o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${n}`}}),d.value=!1,b()}catch(o){console.error(o)}},g=async o=>{try{await B.delete(`/api/products/${o}`,{headers:{Authorization:`Bearer ${V}`,Accept:"application/json"}}),b()}catch(n){console.error(n)}};return Ce(()=>{b()}),(o,n)=>{const k=pe,c=de;return Z(),O(H,null,{default:u(()=>[t(M,{cols:"12"},{default:u(()=>[t(J,null,{default:u(()=>[t(K,null,{default:u(()=>[t(z,{color:"primary",onClick:I},{default:u(()=>[x(" Add Product ")]),_:1})]),_:1}),t(Q,null,{default:u(()=>[t(Ie,{headers:s,items:v.value,loading:h.value},{"item.price":u(({item:i})=>[x(q(i.price)+" DZD ",1)]),"item.photo":u(({item:i})=>[i.photo?(Z(),O(Ae,{key:0,src:`/storage/${i.photo}`,width:"50",height:"50",cover:""},null,8,["src"])):Pe("",!0)]),"item.actions":u(({item:i})=>[t(z,{icon:"",size:"small",color:"primary",variant:"text",onClick:S=>A(i)},{default:u(()=>[t(G,{icon:"tabler-edit"})]),_:2},1032,["onClick"]),t(z,{icon:"",size:"small",color:"error",variant:"text",onClick:S=>g(i.id)},{default:u(()=>[t(G,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),_:2},1032,["items","loading"])]),_:1})]),_:1})]),_:1}),t(Re,{modelValue:d.value,"onUpdate:modelValue":n[5]||(n[5]=i=>d.value=i),"max-width":"800"},{default:u(()=>[t(J,null,{default:u(()=>[t(K,null,{default:u(()=>[x(q(l.value.id?"Edit":"Add")+" Product",1)]),_:1}),t(Q,null,{default:u(()=>[t(we,{onSubmit:_e(w,["prevent"])},{default:u(()=>[t(k,{modelValue:l.value.title,"onUpdate:modelValue":n[0]||(n[0]=i=>l.value.title=i),label:"Title",class:"mb-4"},null,8,["modelValue"]),t(c,{modelValue:l.value.description,"onUpdate:modelValue":n[1]||(n[1]=i=>l.value.description=i),label:"Description",class:"mb-4"},null,8,["modelValue"]),t(H,{class:"mb-4"},{default:u(()=>[t(M,{cols:"12",md:"6"},{default:u(()=>[t(k,{modelValue:l.value.price,"onUpdate:modelValue":n[2]||(n[2]=i=>l.value.price=i),label:"Price",type:"number",min:"0",step:"0.01"},null,8,["modelValue"])]),_:1}),t(M,{cols:"12",md:"6"},{default:u(()=>[t(k,{modelValue:l.value.stock,"onUpdate:modelValue":n[3]||(n[3]=i=>l.value.stock=i),label:"Stock",type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),_:1}),t(Me,{modelValue:p.value,"onUpdate:modelValue":n[4]||(n[4]=i=>p.value=i),label:"Product Image",accept:"image/*","prepend-icon":"tabler-camera",class:"mb-4"},null,8,["modelValue"]),t(z,{type:"submit",color:"primary"},{default:u(()=>[x(" Save ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{pt as default};
