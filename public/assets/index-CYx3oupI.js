import{a as g}from"./axios-DGDcxXwr.js";import{r as k,ad as D,D as I,f as v,e,o as c,b as a,s as n,t as o,c as l,d,a3 as B,p as S,$ as T,h as L,F as $,a as z,P as A,Q as P}from"./main-Dc8fLLio.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as R,a as E}from"./VRow-TywjCKkg.js";import{V as F,b as M}from"./VCard-CkB6CIXi.js";import{V as j}from"./VCardText-DxD8k5-8.js";import{V as O}from"./VDataTable-CnUCRCFb.js";import{V}from"./VChip-DXfzaw2X.js";import{V as Q}from"./VMenu-Bs42EHWd.js";import{V as Z,a as q,b as U}from"./VList-DJa-ehqo.js";/* empty css              */import"./VAvatar-CuFlpItv.js";import"./VImg-BDT53czw.js";import"./VPagination-tEoifavA.js";import"./VSelect-CFNDzyn7.js";import"./VTextField-BtIlFlGn.js";import"./forwardRefs-DWGaNmQL.js";import"./VOverlay-C_apeV14.js";import"./scopeId-CyTsLL5x.js";import"./VCheckboxBtn-DoNR63xf.js";import"./VSelectionControl-B1Qq_A9U.js";import"./VDivider-D6pnG8a5.js";const G=u=>(A("data-v-062c979a"),u=u(),P(),u),H={key:1},J={key:0},K={class:"font-weight-medium"},W=G(()=>d("div",{class:"text-caption text-grey"},"Registered user",-1)),X={key:1},Y={class:"font-weight-medium"},tt={class:"text-caption text-grey"},et={class:"text-caption text-grey"},at={key:2},ot={__name:"index",setup(u){const m=k([]),_=k(!1),b=["en_attente","confirme","livre"],f=D("accessToken").value,x=[{title:"ID",key:"id"},{title:"Product",key:"product.title"},{title:"Buyer",key:"buyer_info"},{title:"Quantity",key:"quantity"},{title:"Total Price",key:"total_price"},{title:"Status",key:"status"},{title:"Date",key:"created_at"},{title:"Actions",key:"actions"}],y=async()=>{var r;_.value=!0;try{const{data:s}=await g.get("/api/orders",{headers:{Authorization:`Bearer ${f}`,Accept:"application/json"}});m.value=s}catch(s){console.error("Error fetching orders:",((r=s.response)==null?void 0:r.data)||s.message)}finally{_.value=!1}},w=async(r,s)=>{var p;try{await g.put(`/api/orders/${r}/status`,{status:s},{headers:{Authorization:`Bearer ${f}`,Accept:"application/json"}}),await y()}catch(t){console.error("Error updating status:",((p=t.response)==null?void 0:p.data)||t.message)}},h=r=>{switch(r){case"en_attente":return"warning";case"confirme":return"info";case"livre":return"success";default:return"secondary"}},C=r=>new Date(r).toLocaleDateString();return I(()=>{y()}),(r,s)=>{const p=z("RouterLink");return c(),v(R,null,{default:e(()=>[a(E,{cols:"12"},{default:e(()=>[a(F,null,{default:e(()=>[a(M,null,{default:e(()=>[n("Orders Management")]),_:1}),a(j,null,{default:e(()=>[a(O,{headers:x,items:m.value,loading:_.value,"items-per-page":10},{"item.product.title":e(({item:t})=>[t.product?(c(),v(p,{key:0,to:`/products/${t.product.id}`,class:"text-primary"},{default:e(()=>[n(o(t.product.title),1)]),_:2},1032,["to"])):(c(),l("span",H,"Product deleted"))]),"item.buyer_info":e(({item:t})=>[t.buyer?(c(),l("div",J,[d("div",K,o(t.buyer.name),1),W])):t.guest_buyer?(c(),l("div",X,[d("div",Y,o(t.guest_buyer.full_name),1),d("div",tt,o(t.guest_buyer.email)+" • "+o(t.guest_buyer.wilaya),1),d("div",et,o(t.guest_buyer.phone),1)])):(c(),l("span",at,"Unknown buyer"))]),"item.total_price":e(({item:t})=>[n(o(new Intl.NumberFormat("fr-DZ").format(t.total_price))+" DZD ",1)]),"item.status":e(({item:t})=>[a(V,{color:h(t.status),size:"small"},{default:e(()=>[n(o(t.status.replace("_"," ")),1)]),_:2},1032,["color"])]),"item.created_at":e(({item:t})=>[n(o(C(t.created_at)),1)]),"item.actions":e(({item:t})=>[a(Q,null,{activator:e(({props:i})=>[a(B,S({icon:"",size:"small"},i),{default:e(()=>[a(T,{icon:"tabler-dots-vertical"})]),_:2},1040)]),default:e(()=>[a(Z,{density:"compact"},{default:e(()=>[(c(),l($,null,L(b,i=>a(q,{key:i,value:i,onClick:rt=>w(t.id,i)},{default:e(()=>[a(U,null,{default:e(()=>[a(V,{color:h(i),size:"small",class:"mr-2"},{default:e(()=>[n("   ")]),_:2},1032,["color"]),n(" "+o(i.replace("_"," ")),1)]),_:2},1024)]),_:2},1032,["value","onClick"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1032,["items","loading"])]),_:1})]),_:1})]),_:1})]),_:1})}}},It=N(ot,[["__scopeId","data-v-062c979a"]]);export{It as default};
