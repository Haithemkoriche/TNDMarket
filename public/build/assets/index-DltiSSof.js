import{V as j,_ as E}from"./VForm-Div2171k.js";import{r as n,ad as F,D as I,f as M,e as t,o as N,b as e,a3 as c,s as u,t as f,$ as y,a2 as P}from"./main-BaaxU7u_.js";import{a as d}from"./axios-DGDcxXwr.js";import{V as k,a as V}from"./VRow-DWkoVhRZ.js";import{V as C,b as S}from"./VCard-qOwQnKaN.js";import{V as A}from"./VCardText-DHqodwx9.js";import{V as O,a as h}from"./VDataTable--edFkA1N.js";import{V as R}from"./VChip-CcYLCn_t.js";import{V as q}from"./VDialog-DkWi3ux5.js";import"./VTextField-DX4T_R8n.js";import"./VImg-CsLNaE2M.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VAvatar-fH7oXIj0.js";import"./VList-BMN_Y16l.js";import"./VDivider-UFgmqBFa.js";import"./VOverlay-5QeYpmUP.js";import"./scopeId-BisKJNJb.js";import"./VMenu-62ETFCUt.js";import"./VCheckboxBtn-ChYJ_Ojh.js";import"./VSelectionControl-cya76OLo.js";const pe={__name:"index",setup(G){const _=n([]),b=n([]),p=n(!1),s=n(!1),l=n({centre_id:null,status:"active",start_date:null,end_date:null,price:0}),i=F("accessToken").value,g=[{title:"Active",value:"active"},{title:"Suspended",value:"suspended"},{title:"Cancelled",value:"cancelled"}],w=[{title:"ID",key:"id"},{title:"Centre",key:"centre.name"},{title:"Status",key:"status"},{title:"Start Date",key:"start_date"},{title:"End Date",key:"end_date"},{title:"Price",key:"price"},{title:"Actions",key:"actions"}],m=async()=>{p.value=!0;try{const{data:o}=await d.get("/api/admin/subscriptions",{headers:{Authorization:`Bearer ${i}`,Accept:"application/json"}});_.value=o}catch(o){console.error(o)}finally{p.value=!1}},x=async()=>{try{const{data:o}=await d.get("/api/admin/centres",{headers:{Authorization:`Bearer ${i}`,Accept:"application/json"}});b.value=o}catch(o){console.error(o)}},$=()=>{l.value={centre_id:null,status:"active",start_date:null,end_date:null,price:0},s.value=!0},D=o=>{l.value={...o},s.value=!0},B=async()=>{try{l.value.id?await d.put(`/api/admin/subscriptions/${l.value.id}`,{...l.value,headers:{Authorization:`Bearer ${i}`,Accept:"application/json"}}):await d.post("/api/admin/subscriptions",l.value,{headers:{Authorization:`Bearer ${i}`,Accept:"application/json"}}),s.value=!1,m()}catch(o){console.error(o)}},z=async o=>{try{await d.delete(`/api/admin/subscriptions/${o}`,{headers:{Authorization:`Bearer ${i}`,Accept:"application/json"}}),m()}catch(r){console.error(r)}},T=o=>{switch(o){case"active":return"success";case"suspended":return"warning";case"cancelled":return"error";default:return"secondary"}};return I(()=>{m(),x()}),(o,r)=>{const v=E;return N(),M(k,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(C,null,{default:t(()=>[e(S,null,{default:t(()=>[e(c,{color:"primary",onClick:$},{default:t(()=>[u(" Add Subscription ")]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(O,{headers:w,items:_.value,loading:p.value},{"item.status":t(({item:a})=>[e(R,{color:T(a.status)},{default:t(()=>[u(f(a.status),1)]),_:2},1032,["color"])]),"item.price":t(({item:a})=>[u(f(a.price)+" â‚¬ ",1)]),"item.actions":t(({item:a})=>[e(c,{icon:"",size:"small",color:"primary",variant:"text",onClick:U=>D(a)},{default:t(()=>[e(y,{icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(c,{icon:"",size:"small",color:"error",variant:"text",onClick:U=>z(a.id)},{default:t(()=>[e(y,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),_:2},1032,["items","loading"])]),_:1})]),_:1})]),_:1}),e(q,{modelValue:s.value,"onUpdate:modelValue":r[5]||(r[5]=a=>s.value=a),"max-width":"800"},{default:t(()=>[e(C,null,{default:t(()=>[e(S,null,{default:t(()=>[u(f(l.value.id?"Edit":"Add")+" Subscription",1)]),_:1}),e(A,null,{default:t(()=>[e(j,{onSubmit:P(B,["prevent"])},{default:t(()=>[e(h,{modelValue:l.value.centre_id,"onUpdate:modelValue":r[0]||(r[0]=a=>l.value.centre_id=a),items:b.value,"item-title":"name","item-value":"id",label:"Centre",class:"mb-4"},null,8,["modelValue","items"]),e(h,{modelValue:l.value.status,"onUpdate:modelValue":r[1]||(r[1]=a=>l.value.status=a),items:g,label:"Status",class:"mb-4"},null,8,["modelValue"]),e(k,{class:"mb-4"},{default:t(()=>[e(V,{cols:"12",md:"6"},{default:t(()=>[e(v,{modelValue:l.value.start_date,"onUpdate:modelValue":r[2]||(r[2]=a=>l.value.start_date=a),label:"Start Date",type:"date"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:t(()=>[e(v,{modelValue:l.value.end_date,"onUpdate:modelValue":r[3]||(r[3]=a=>l.value.end_date=a),label:"End Date",type:"date"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{modelValue:l.value.price,"onUpdate:modelValue":r[4]||(r[4]=a=>l.value.price=a),label:"Price",type:"number",min:"0",step:"0.01",class:"mb-4"},null,8,["modelValue"]),e(c,{type:"submit",color:"primary"},{default:t(()=>[u(" Save ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{pe as default};
