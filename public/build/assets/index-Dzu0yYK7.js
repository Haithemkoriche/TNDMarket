import{_ as N}from"./AppTextarea-DbTzv2XX.js";import{V as j,_ as z}from"./VForm-Div2171k.js";import{r as u,ad as L,D as P,f as p,e as a,o as i,b as e,a3 as k,s as f,$ as R,a2 as S,c as E,h as M,F as O,x as A}from"./main-BaaxU7u_.js";import{a as _}from"./axios-DGDcxXwr.js";import{V as w,a as y}from"./VRow-DWkoVhRZ.js";import{V as h,b as x}from"./VCard-qOwQnKaN.js";import{V as F}from"./VCardText-DHqodwx9.js";import{V as I,a as q}from"./VDataTable--edFkA1N.js";import{V as G}from"./VDialog-DkWi3ux5.js";import"./VTextField-DX4T_R8n.js";import"./VImg-CsLNaE2M.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VAvatar-fH7oXIj0.js";import"./VList-BMN_Y16l.js";import"./VDivider-UFgmqBFa.js";import"./VOverlay-5QeYpmUP.js";import"./scopeId-BisKJNJb.js";import"./VMenu-62ETFCUt.js";import"./VCheckboxBtn-ChYJ_Ojh.js";import"./VSelectionControl-cya76OLo.js";import"./VChip-CcYLCn_t.js";const _e={__name:"index",setup(H){const g=u([]),V=u([]),v=u(!1),d=u(!1),t=u({form_type_id:null,patient_name:"",patient_surname:"",form_data:{}}),C=[{title:"ID",key:"id"},{title:"Patient",key:"patient_name"},{title:"Type",key:"form_type.name"},{title:"Date",key:"created_at"},{title:"Actions",key:"actions"}],c=L("accessToken").value,T=async()=>{v.value=!0;try{const{data:r}=await _.get("/api/forms",{headers:{Authorization:`Bearer ${c}`,Accept:"application/json"}});g.value=r}catch(r){console.error(r)}finally{v.value=!1}},U=async()=>{try{const{data:r}=await _.get("/api/form-types",{headers:{Authorization:`Bearer ${c}`,Accept:"application/json"}});V.value=r}catch(r){console.error(r)}},$=()=>{t.value={form_type_id:null,patient_name:"",patient_surname:"",form_data:{}},d.value=!0},B=async()=>{try{await _.post("/api/forms",t.value,{headers:{Authorization:`Bearer ${c}`,Accept:"application/json"}}),d.value=!1,T()}catch(r){console.error(r)}},D=async r=>{try{const o=await _.get(`/api/forms/${r}/pdf`,{responseType:"blob",headers:{Authorization:`Bearer ${c}`,Accept:"application/pdf"}}),m=window.URL.createObjectURL(new Blob([o.data],{type:"application/pdf"})),s=document.createElement("a");s.href=m,s.setAttribute("download",`form_${r}.pdf`),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(m),window.open(m)}catch(o){console.error("PDF generation error:",o.response||o.message||o)}};return P(()=>{T(),U()}),(r,o)=>{const m=z,s=N;return i(),p(w,null,{default:a(()=>[e(y,{cols:"12"},{default:a(()=>[e(h,null,{default:a(()=>[e(x,null,{default:a(()=>[e(k,{color:"primary",onClick:$},{default:a(()=>[f(" New Form ")]),_:1})]),_:1}),e(F,null,{default:a(()=>[e(I,{headers:C,items:g.value,loading:v.value},{"item.actions":a(({item:n})=>[e(k,{icon:"",size:"small",color:"primary",variant:"text",onClick:l=>D(n.id)},{default:a(()=>[e(R,{icon:"tabler-file-download"})]),_:2},1032,["onClick"])]),_:2},1032,["items","loading"])]),_:1})]),_:1})]),_:1}),e(G,{modelValue:d.value,"onUpdate:modelValue":o[3]||(o[3]=n=>d.value=n),"max-width":"800"},{default:a(()=>[e(h,null,{default:a(()=>[e(x,null,{default:a(()=>[f("Create New Form")]),_:1}),e(F,null,{default:a(()=>[e(j,{onSubmit:S(B,["prevent"])},{default:a(()=>[e(q,{modelValue:t.value.form_type_id,"onUpdate:modelValue":o[0]||(o[0]=n=>t.value.form_type_id=n),items:V.value,"item-title":"name","item-value":"id",label:"Form Type",class:"mb-4"},null,8,["modelValue","items"]),e(w,null,{default:a(()=>[e(y,{cols:"12",md:"6"},{default:a(()=>[e(m,{modelValue:t.value.patient_name,"onUpdate:modelValue":o[1]||(o[1]=n=>t.value.patient_name=n),label:"Patient Name"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:a(()=>[e(m,{modelValue:t.value.patient_surname,"onUpdate:modelValue":o[2]||(o[2]=n=>t.value.patient_surname=n),label:"Patient Surname"},null,8,["modelValue"])]),_:1})]),_:1}),t.value.form_type_id?(i(),p(h,{key:0,class:"mb-4"},{default:a(()=>[e(x,null,{default:a(()=>[f("Form Fields")]),_:1}),e(F,null,{default:a(()=>[e(w,null,{default:a(()=>{var n;return[(i(!0),E(O,null,M(((n=V.value.find(l=>l.id===t.value.form_type_id))==null?void 0:n.fields)||[],l=>(i(),p(y,{key:l.name,cols:"12"},{default:a(()=>[l.type==="text"||l.type==="number"?(i(),p(m,{key:0,modelValue:t.value.form_data[l.name],"onUpdate:modelValue":b=>t.value.form_data[l.name]=b,label:l.label,type:l.type==="number"?"number":"text"},null,8,["modelValue","onUpdate:modelValue","label","type"])):l.type==="textarea"?(i(),p(s,{key:1,modelValue:t.value.form_data[l.name],"onUpdate:modelValue":b=>t.value.form_data[l.name]=b,label:l.label},null,8,["modelValue","onUpdate:modelValue","label"])):A("",!0)]),_:2},1024))),128))]}),_:1})]),_:1})]),_:1})):A("",!0),e(k,{type:"submit",color:"primary"},{default:a(()=>[f(" Submit ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{_e as default};
